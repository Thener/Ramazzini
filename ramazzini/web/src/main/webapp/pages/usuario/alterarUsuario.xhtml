<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
   xmlns:ui="http://java.sun.com/jsf/facelets"
   xmlns:f="http://java.sun.com/jsf/core"
   xmlns:h="http://java.sun.com/jsf/html"
   xmlns:p="http://primefaces.org/ui"
   template="/WEB-INF/templates/default.xhtml">
   <ui:define name="content">
   
      <h:form id="frmAlterarUsuario">   
     	  <p:growl id="growl" showDetail="true" sticky="true" />        	   
	      <p:tabView id="tabViewAlterarUsuario">
		        <p:tab title="Dados Básicos">
		            <p:panel id="panelDadosUsuario" header="Dados do Usuário" style="margin-bottom:20px">
				        <p:panelGrid columns="4" cellpadding="10">	      	   
					        <p:outputLabel for="nome" value="Nome:"/>
				            <p:inputText id="nome" value="#{usuarioController.usuarioSelecionado.nome}" required="true" readonly="#{usuarioController.somenteLeitura}"/>            
				            
				            <p:outputLabel for="login" value="Email:"/>
				            <p:inputText id="login" value="#{usuarioController.usuarioSelecionado.login}" required="true" readonly="#{usuarioController.somenteLeitura}"/>
				            
				            <p:outputLabel for="senha" value="Nova senha:" rendered="#{!usuarioController.somenteLeitura}"/>
				            <p:password id="senha" value="#{usuarioController.senhaNova}" rendered="#{!usuarioController.somenteLeitura}"/>
				            
				            <p:outputLabel for="ativoCheck" value="Ativo: " />
				        	<p:selectBooleanCheckbox id="ativoCheck" value="#{usuarioController.usuarioSelecionado.ativo}" readonly="#{usuarioController.somenteLeitura}"/>
						</p:panelGrid>				        
			    	</p:panel>
		        </p:tab>
		        <p:tab title="Perfis">
		        	<p:panel id="panelPerfisUsuario" header="Adicionar Perfil ao usuário: #{usuarioController.usuarioSelecionado.nome}" style="margin-bottom:20px">
						<p:panelGrid columns="3" cellpadding="10" rendered="#{not empty usuarioController.perfisDisponiveis}"> 
							<p:outputLabel for="perfil" value="Perfil:" />
							<p:selectOneMenu id="perfil" readonly="#{usuarioController.somenteLeitura}"
								value="#{usuarioController.perfilSelecionado}"
								converter="entityConverter">
								<f:selectItem itemLabel="Selecione o perfil" itemValue=""
									noSelectionOption="true" />
								<f:selectItems value="#{usuarioController.perfisDisponiveis}"
									var="perfil" itemLabel="#{perfil.nome}" />
							</p:selectOneMenu>	
							<p:commandButton action="#{usuarioController.adicionarPerfil()}" value="Incluir"
								icon="ui-icon-check" ajax="true" update="panelPerfisUsuario" disabled="#{usuarioController.somenteLeitura}"/>
														
						</p:panelGrid>
						<p:separator/>
						
						<p:dataTable var="perfil" value="#{usuarioController.perfisUsuario}"
							id="gridPerfis" emptyMessage="O usuário selecionado não possui perfil.">
							<f:facet name="header"> Perfis do Usuário </f:facet>
														
							<p:column headerText="Nome">
								<h:outputText value="#{perfil.nome}" />
							</p:column>

							<p:column headerText="Ações" style="width:10%;">
								<p:panelGrid columns="1" styleClass="semBorda">
									<p:commandLink title="excluir" disabled="#{usuarioController.somenteLeitura}"
										action="#{usuarioController.removerPerfilUsuario(perfil)}"
										styleClass="ui-icon ui-icon-closethick" update="gridPerfis, :frmAlterarUsuario:tabViewAlterarUsuario:perfil">
										<p:confirm header="Confirmação" message="Tem certeza que deseja excluir o perfil selecionado?" icon="ui-icon-alert" />
									</p:commandLink>									
								</p:panelGrid>
							</p:column>
						</p:dataTable>
					</p:panel>					
				</p:tab>   				
	    	</p:tabView> 
	    	<p:toolbar id="toolBar">
				<f:facet name="left">				
				<p:commandButton id="botaoVoltar" immediate="true"
					icon="ui-icon-arrowreturnthick-1-w" title="Voltar"
					action="pesquisarUsuario.jsf?faces-redirect=true">
				</p:commandButton>
				<p:commandButton id="salvar"
					action="#{usuarioController.atualizar()}" value="Salvar"
					icon="ui-icon-disk" title="Salvar" styleClass="register"
					update="frmAlterarUsuario"
					disabled="#{usuarioController.somenteLeitura}" />
				</f:facet>
			</p:toolbar>  
			<p:confirmDialog global="true" showEffect="fade" hideEffect="explode">
				<p:commandButton value="Sim" type="button"
					styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
				<p:commandButton value="Não" type="button"
					styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
			</p:confirmDialog>  	    	
		</h:form>
	</ui:define>
</ui:composition>
